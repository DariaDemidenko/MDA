{% extends "layout.html" %}
{% block content %}
   <div class="row">
      <!-- Начало левой колонки -->
      <div class="col-md-3 float-left">
         <!-- Локация -->
         <div class="row">
            <div class="col-md-4 imback_height locback p-1">
               <div class="row">
                  <div class="col-md-12 imback_height_half">
                     <div class="text-center small-text" style="text-decoration: underline">
                        Локация
                     </div>
                     <div class="text-center small-text">
                        "локация"
                     </div>
                  </div>
               </div>
               <div class="row">
                  <div class="col-md-12 imback_height_half">
                     <div class="text-center small-text" style="text-decoration: underline">
                        Роль
                     </div>
                     <div class="text-center small-text">
                        "роль"
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-md-8 imback_height imback pl-1 pr-1 pt-2 pb-2 align-items-center rounded-right">
               <img src="{{ url_for('static', filename='9.jpg') }}" alt="" class="img-fluid">
            </div>
         </div>
         <!-- Часики -->
         <div class="row">
               <div class="col-md-12">
                  <!DOCTYPE HTML>
                  <html>
                     <head>
                        <meta name="viewport" content="width=device-width, initial-scale=1">
                           <style>
                              p {
                                 text-align: center;
                                 font-size: 30px;
                                 margin-top: 0px;
                                 }
                           </style>
                     </head>
                  <body>

                     <p id="demo"></p>

                     <script>
                  // Set the date we're counting down to
                     var countDownDate = new Date("Dec 27, 2018 21:52:00").getTime();

                  // Update the count down every 1 second
                     var x = setInterval(function() {

                    // Get todays date and time
                     var now = new Date().getTime();

                    // Find the distance between now and the count down date
                     var distance = countDownDate - now;

                    // Time calculations for days, hours, minutes and seconds
                     var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                     var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                     var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                     var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    // Output the result in an element with id="demo"
                    document.getElementById("demo").innerHTML = hours + "h "
                    + minutes + "m " + seconds + "s ";

                    // If the count down is over, write some text
                    if (distance < 0) {
                      clearInterval(x);
                      document.getElementById("demo").innerHTML = "EXPIRED";
                    }
                  }, 1000);
                  </script>

                  </body>
                  </html>
               </div>
         </div>
         <!-- Кнопка голосовать/угадать локацию -->
            {% if current_user.role == 'шпион' %}
               <!-- Кнопка угадать локацию -->
               <div class="row">
                  <div class="col-md-12 center-block">
                     <!-- Button trigger modal -->
                     <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                       Угадать локацию
                     </button>

                     <!-- Modal -->
                     <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                       <div class="modal-dialog modal-dialog-centered" role="document">
                         <div class="modal-content">
                           <div class="modal-header">
                             <h5 class="modal-title" id="exampleModalLabel">Где мы?</h5>
                             <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                               <span aria-hidden="true">&times;</span>
                             </button>
                           </div>
                           <div class="modal-body">
                             ...
                           </div>
                           <div class="modal-footer">
                              <button type="button" class="btn btn-primary">Угадать</button>
                           </div>
                         </div>
                       </div>
                     </div>
                  </div>
               </div>
            {% else %}
               <!-- Кнопка голосовать -->
               <div class="row">
                  <div class="col-md-12">
                  <!-- Button trigger modal -->
                     <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
                       Угадать шпиона
                     </button>

                     <!-- Modal -->
                     <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                       <div class="modal-dialog modal-dialog-centered" role="document">
                         <div class="modal-content">
                           <div class="modal-header">
                             <h5 class="modal-title" id="exampleModalLongTitle">Кто шпион?</h5>
                             <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                               <span aria-hidden="true">&times;</span>
                             </button>
                           </div>
                           <div class="modal-body">
                             ...
                           </div>
                           <div class="modal-footer">
                                <button type="button" class="btn btn-primary">Угадать</button>
                           </div>
                         </div>
                       </div>
                     </div>
                  </div>
               </div>
            {% endif %}
         <!-- Кнопка выйти -->
         <div class="row justify-content-center">
            <a href="http://localhost:5000" class="btn btn-primary btn-lg">Выйти</a>
         </div>
      </div>
      <!-- Конец левой колонки -->

      <!-- Начало правой колонки -->
      <div class="col-md-9">
         <!-- Игроки -->
         <div class="row mt-1">
            <div class="col text-center titles">
               Игроки:
            </div>
         </div>
         <div class="row mt-4">
            {% for user in users %}
               <div class="col text-center titles_2">
                  {{ user.username }}
                  <img src="{{ url_for('static', filename='circle1.png') }}" class="mx-auto d-block">
               </div>

            {% endfor %}
         </div>
         <!-- Чат -->
         <div class="container mt-5 mb-5 pl-5 pr-5">
            <article class="media p-2 rounded" style="background: #ffffff">
               <div class="media-content">
                 <div class="content border-bottom border-secondary">
                   <p>
                     <strong>Username</strong>
                     <br> Some message
                   </p>
                 </div>
                 <div class="content border-bottom border-secondary">
                   <p>
                     <strong>Username</strong>
                     <br> Some message1111111111111111
                   </p>
                 </div>
               </div>
            </article>
            <div class="row mt-2 mb-2 p-1">
               {{ form.hidden_tag() }}
               <div class="col-md-10">
                  {{ form.message(class="form-control form-control-sm") }}
               </div>
               <div class="col-md-2">
                  {{ form.submit(class="btn btn-default btn-sm") }}
               </div>


            </div>
         </div>
      </div>
      <!-- Конец правой колонки -->
   </div>

   <script src="https://js.pusher.com/4.3/pusher.min.js"></script>
   <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
   crossorigin="anonymous"></script>

   <script>

      $(function() {
         '{{ form.submit }}'.on('click', function() {
            let  username = '{{ current_user.username }}'
            alert(username);
         })

      });

       // Enable pusher logging - don't include this in production
       Pusher.logToConsole = true;

       var pusher = new Pusher('1b9338044af70a030649', {
         cluster: 'ap3',
         forceTLS: true
       });

       var channel = pusher.subscribe('my-channel');
       channel.bind('my-event', function(data) {
         alert(JSON.stringify(data));
       });
   </script>
   <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
   <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
{% endblock content %}
